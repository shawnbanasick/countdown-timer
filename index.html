<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="apple-mobile-web-app-title" content="EQ Mobile" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <!-- <meta
      name="viewport"
      content="viewport-fit=cover, user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1"
    /> -->
    <meta
      name="viewport"
      content="viewport-fit=cover, width=device-width, user-scalable=no, initial-scale=1"
    />

    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <title>Countdown Timer</title>

    <script src="src/jquery-3.6.0.min.js"></script>
    <script src="src/jquery.fittext.js"></script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
      integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="stylesheets/jquery.mobile-1.4.5.css" />
    <link
      rel="stylesheet"
      href="stylesheets/stylesheet.css"
      type="text/css"
      charset="utf-8"
    />
    <link rel="stylesheet" href="custom.css" />

    <!--    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?" />
    <link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad.png" />

    <link
      rel="apple-touch-icon"
      sizes="167x167"
      href="touch-icon-ipad-retina.png"
    /> -->

    <!-- iPad Pro 12.9" (2048px x 2732px) 
    <link
      rel="apple-touch-startup-image"
      media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)"
      href="/apple-launch-2048x2732.png" 
    /> -->

    <!-- iPad Pro 11” (1668px x 2388px) 
    <link
      rel="apple-touch-startup-image"
      media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)"
      href="/apple-launch-1668x2388.png" 
    /> -->

    <!-- iPad Pro 10.5" (1668px x 2224px) 
    <link
      rel="apple-touch-startup-image"
      media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)"
      href="/apple-launch-1668x2224.png"
    /> -->

    <!-- <link rel="manifest" href="eq-mobile.webmanifest" />
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          navigator.serviceWorker.register("/eq-mobile/sw.js").then(
            function (registration) {
              // Registration was successful
              console.log(
                "ServiceWorker registration successful with scope: ",
                registration.scope
              );
            },
            function (err) {
              // registration failed :(
              console.log("ServiceWorker registration failed: ", err);
            }
          );
        });
      }
    </script>  -->
  </head>

  <body>
    <div class="container">
      <div>
        <input id="totalTime" />
        <div class="buttonsHolder">
          <button class="btn" id="goButton">Start</button>
          <button class="btn" id="goButton">Stop</button>
        </div>
        <div class="spacerDiv"></div>
        <div class="spacerDiv"></div>
        <label for="yellowTime">Yellow at:</label>
        <input id="yellowTime" />
        <div class="spacerDiv"></div>
        <div class="spacerDiv"></div>

        <label for="orangeTime">Orange at:</label>
        <input id="orangeTime" />
      </div>
      <div class="rightContainer">
        <div class="digital">0</div>
        <div class="seconds"></div>
      </div>
    </div>
    <script>
      $(document).ready(function () {
        let time;
        let tmp;
        let x;
        let counter;
        let sec;

        // timer
        function myTimer() {
          var c = tmp--,
            m = (c / 60) >> 0;

          if (tmp === 0) {
            tmp = tmp - 59;
            $("body").css("background-color", "red");
            $(".digital").css("color", "black");
            $(".btn")
              .removeClass("btnOrange", "btnYellow", "btn")
              .addClass("btnRed");
            $(".seconds").css("color", "black");
          }
          // tmp != 0 || (tmp = time);
          x.text(m);
          x.fitText(0.15);
          sec.text(tmp - 59);

          // with 10 minutes left
          if (tmp - 58 === 600) {
            $("body").css("background-color", "#FFCC00");
            $(".digital").css("color", "black");
            $(".btn").removeClass("btn").addClass("btnYellow");
            $(".seconds").css("color", "black");
          }

          if (tmp - 58 === 300) {
            $("body").css("background-color", "orange");
            $(".digital").css("color", "black");
            $(".btn").removeClass("btn", "btnYellow").addClass("btnOrange");
            $(".seconds").css("color", "black");
          }

          if (tmp - 55 === 0) {
            console.log("clearing");
            // clearInterval(counter);
          }
        }

        // start button
        $("#goButton").click(function () {
          if (counter) {
            clearInterval(counter);
          }
          let input = $("#totalTime").val();
          console.log(input);
          time = input * 60 + 59;
          tmp = time;
          x = $(".digital");
          sec = $(".seconds");

          counter = setInterval(myTimer, 1000);
        });
      });
    </script>
  </body>
</html>
